spring.application.name=music

# Database Configuration
# These values are loaded from environment variables for security
spring.datasource.url=${DB_URL:jdbc:postgresql://vjiki-vjiki.h.aivencloud.com:23946/defaultdb?sslmode=require}
spring.datasource.username=${DB_USERNAME:}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver

# SSL Configuration
spring.datasource.hikari.ssl=true
spring.datasource.hikari.ssl-mode=require

# Connection Pool Configuration (Aiven has 20 connection limit)
# Using minimal settings to reduce database connections
spring.datasource.hikari.maximum-pool-size=2
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=900000
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.auto-commit=false

# JPA Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.default_schema=music
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# Actuator Configuration for Health Check
# Expose health endpoint at /healthz for Render.com health checks
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=when-authorized
management.health.defaults.enabled=true
management.server.port=${SERVER_PORT:8080}
# Custom health endpoint path
management.endpoints.web.base-path=/
management.endpoint.health.group.custom.include=*
# Map /healthz to health endpoint
server.servlet.context-path=
